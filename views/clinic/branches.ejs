<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <h4 class="page-title">Branches</h4>
            </div>
        </div>
    </div>
    <div class="modal-container"></div>
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body"> 
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div class="d-flex justify-content-center align-items-center">
                            <div class="input-group w-100 align-items-center">
                                <button type = "button" class="request-btn input-group-text bg-primary border-primary text-white brand-bg-color align-items-center"
                                data-bs-toggle="modal" data-bs-target="#addBranchModal">
                                    Request
                                </button>
                            </div>
                            <!-- Branches -->
                            <div class="modal fade" id="addBranchModal" tabindex="-1" aria-labelledby="addServiceLabel" aria-hidden="true">
                                <div class="modal-dialog modal-lg">
                                  <div class="modal-content">
                                    <div class="modal-header" >
                                      <h5 class="modal-title" id="addServiceLabel">Request</h5>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                      <form id="branch-request-form">
                              
                                        <div class="mb-3">
                                          <label for="bName" class="form-label">Address:</label>
                                          <input type="text" class="form-control" id="branch_address" name="branch_address">
                                          <div class="text-danger" id="branch_error"></div>
                                        </div>

                                        
                                        <div class="mb-3">
                                            <label for="bName" class="form-label">Village:</label><br>
                                            <select id="villageSelect" name ="village" class = "select-form">
                                                <option value="">Choose Village</option>
                                                <% villages.forEach((village) => { %>
                                                <option value="<%= village.village_id %>"><%=village.name%></option>
                                                <% }); %>
                                            </select>
                                             <div class="text-danger" id="village_error"></div>
                                        </div>

                                        <div class="mb-3">
                                            <label for="bName" class="form-label">Postcode:</label>
                                            <input type="text" class="form-control" id="postcode" name="postcode">
                                            <div class="text-danger" id="code_error"></div>
                                        </div>
                                        
                                        <div class="mb-3">
                                          <label for="bNum" class="form-label">Contact:</label>
                                          <input type="tel" class="form-control" id="branch_contact" name="mobile_number">
                                          <div class="text-danger" id="phone_error"></div>
                                        </div>
            
                                        <div class="mb-3">
                                          <label for="bCode" class="form-label">License:</label>
                                          <input type="file" class="form-control" id="license" name="license">
                                          <div class="text-danger" id="license_error"></div>
                                        </div>
            
                                        <div class="mb-3">
                                          <label for="product_image" class="form-label">Image:</label>
                                          <input type="file" class="form-control" id="branch_image" name="image" accept=".jpg, .jpeg, .png">
                                          <div class="text-danger" id="image_error"></div>
                                        </div>
            
                                        <div class="mb-3">
                                          <label for="description" class="form-label">Say something to the Admin:</label>
                                          <input type="text" value = ' ' class="form-control" id="descriptionid" name="statement">
                                        </div>
                              
                                      </div>
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="submit" class="btn btn-primary">Submit Request</button>
                                      </div>
                                    </form>
                                  </div>
                                </div>
                              </div>
            
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table id="table-account" class="table table-centered table-nowrap mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th class = "text-center">Address</th>
                                    <th class = "text-center">Village</th>
                                    <th class = "text-center">Postcode</th>
                                    <th class = "text-center">Contact</th>
                                    <th class = "text-center">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% branches.forEach((branch) =>{ %>
                                    <tr class = "table-row">
                                      <td class = "text-center"><%= branch.address%></td>
                                      <td class = "text-center"><%= branch.village%></td>
                                      <td class = "text-center"><%= branch.postcode%></td>
                                      <td class = "text-center"><%= branch.mobile_number%></td>
                                      <td class="td-centered">
                                        <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#viewModal_<%= branch.branch_id %>">
                                            More Data
                                         </button>
                                          <div class="modal fade" id="viewModal_<%= branch.branch_id %>" tabindex="-1" aria-labelledby="viewModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg">
                                              <div class="modal-content">
                                                <div class="modal-header d-flex justify-content-between">
                                                  <h5 class="modal-title" id="viewModalLabel">Branch Data</h5>
                                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <div class="modal-view-body">  
                                                  <div id ="branch-modal" class="d-flex justify-content-between p-3 text-center">
                                                      <div class = "branch-data text-center">
                                                          <h6 class="d-flex justify-content-center">Image</h6>
                                                          <img src = "/branches/profile/<%= branch.image %>">
                                                          <br>
                                                          <br>
                                                          <h6 class="d-flex justify-content-center">License</h6>
                                                          <a href="/branches/license/" download = "<%=branch.license%>">
                                                            <object data="/branches/license/<%=branch.license%>" type="text/plain" width="100%" height="500px">
                                                                <p>Your browser does not support viewing this document. <a href="/branches/license/" download = "<%=branch.license%>">Download the License</a></p>
                                                            </object>
                                                          </a>
                                                      </div>
                                                  </div>
                                                   <br>
                                                   <br>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
          
                                            <div data-bs-toggle="modal" data-branch-id="<%= branch.branch_id %>" data-bs-target="#deleteBranchModal">
                                                <a id="deleteUser" class="btn">
                                                <img class="action icon-red" src="../img/icons/delete.svg" alt="">
                                                </a>
                                            </div>
                                            <div class="modal fade" id="deleteBranchModal" tabindex="-1" role="dialog" aria-labelledby="deletebtnTitle" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered" role="document">
                                                    <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="deletebtnTitle">Delete Confirmation</h5>
                                                        
                                                    </div>
                                                    <div class="modal-body">
                                                        Are you sure you want to delete?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                        <button type="button" id="confirm-delete-btn" class="btn btn-danger">Delete</button>
                                                    </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>  
                                    </tr>
                                    <%}); %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </div>
  